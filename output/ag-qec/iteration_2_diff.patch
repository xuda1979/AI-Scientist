--- paper.tex
+++ paper.tex
@@ -57,7 +57,8 @@
 
 % ---------- In-document, runnable simulation (single source of truth; produces all numbers reported) ----------
 % Use a jobname-derived artifact filename to avoid literal filenames in the source/PDF.
-\begin{filecontents*}[overwrite]{\jobname-artifact}
+% IMPORTANT: write a .py file explicitly to ensure robust shell-escape execution across TeX distributions.
+\begin{filecontents*}[overwrite]{\jobname-artifact.py}
 #!/usr/bin/env python3
 # -*- coding: utf-8 -*-
 """
@@ -493,7 +494,7 @@
         if not args.eta_sweep:
             args.eta_sweep = "0.10,0.30,0.50"
         points = []
-        for tok in args.eta_sweep split(","):
+        for tok in args.eta_sweep.split(","):   # FIXED: added missing dot before split()
             E = float(tok)
             set_seed(args.seed)
             px, pz, *_ = hcf_noise_model(args.L, args.pcl, args.sep_nm, eta_px=E, atten_kappa=args.atten_kappa)
@@ -798,7 +799,7 @@
   (\simpclC,\simpLB)
 }
 % ---------------------------------------------------------------------------------------------------------------
-% Optional: compile-time regeneration of plot coordinates for the rho figure (artifact-driven)
+% Optional: compile-time regeneration of plot coordinates for figures (artifact-driven)
 \newif\ifartifactplots
 % Robust shell-escape detection across engines/distributions
 \begingroup
@@ -815,14 +816,18 @@
 
 \ifartifactplots
   % Generate rho-sweep coordinates directly from the embedded artifact.
-  % This writes a small PGF coordinate block to a jobname-derived artifact file; no filenames appear in the prose.
-  \immediate\write18{python \jobname-artifact --model model2 --L \simL --pcl \simpcl --sep-nm \simsep --eta-px \simeta --rho-sweep \simrhoD,\simrhoA,\simrhoB,\simrhoC,\simrhoE --n \simn --t \simt --trials-bdd \simtrials --seed \simseed --emit-pgf-rho > \jobname-rho.pgf}
+  \immediate\write18{python \jobname-artifact.py --model model2 --L \simL --pcl \simpcl --sep-nm \simsep --eta-px \simeta --rho-sweep \simrhoD,\simrhoA,\simrhoB,\simrhoC,\simrhoE --n \simn --t \simt --trials-bdd \simtrials --seed \simseed --emit-pgf-rho > \jobname-rho.pgf}
+  % Generate length sweep coordinates (points + symmetric Wilson half-widths).
+  \immediate\write18{python \jobname-artifact.py --model model2 --length-sweep \simLfa,\simL,\simLfb --pcl \simpcl --sep-nm \simsep --eta-px \simeta --rho \simrhoB --beta 2.0 --n \simn --t \simt --trials-bdd \simtrials --seed \simseed --emit-pgf-length > \jobname-length.pgf}
+  % Generate power sweep coordinates.
+  \immediate\write18{python \jobname-artifact.py --model model2 --power-sweep \simpclA,\simpclB,\simpclC --L \simL --sep-nm \simsep --eta-px \simeta --rho \simrhoB --beta 2.0 --n \simn --t \simt --trials-bdd \simtrials --seed \simseed --emit-pgf-power > \jobname-power.pgf}
+  % Generate analytic expected run length coordinates.
+  \immediate\write18{python \jobname-artifact.py --rho-sweep \simrhoD,\simrhoA,\simrhoB,\simrhoC,\simrhoE --emit-pgf-runlen > \jobname-runlen.pgf}
 \fi
 
-% Helper to add the rho plot either from the generated file (if present) or from static macros
+% Helpers to add plots either from generated files (if present) or from static macros
 \newcommand{\RhoPlotAdd}{%
   \ifartifactplots
-    % The input file already contains: "coordinates { ... };"
     \addplot+[only marks,mark=o,mark size=2pt, error bars/.cd, y dir=both, y explicit]%
     \input{\jobname-rho.pgf}%
   \else
@@ -830,6 +835,43 @@
       coordinates {
         \rhoPlotCoords
       };
+  \fi
+}
+\newcommand{\LengthPlotAdd}{%
+  \ifartifactplots
+    \addplot+[only marks,mark=*,mark size=2pt, error bars/.cd, y dir=both, y explicit]%
+    \input{\jobname-length.pgf}%
+  \else
+    \addplot+[only marks,mark=*,mark size=2pt]
+      coordinates {
+        \lengthPlotCoords
+      };
+  \fi
+}
+\newcommand{\PowerPlotAdd}{%
+  \ifartifactplots
+    \addplot+[only marks,mark=square*,mark size=2pt, error bars/.cd, y dir=both, y explicit]%
+    \input{\jobname-power.pgf}%
+  \else
+    \addplot+[only marks,mark=square*,mark size=2pt]
+      coordinates {
+        \powerPlotCoords
+      };
+  \fi
+}
+\newcommand{\RunlenPlotAdd}{%
+  \ifartifactplots
+    \addplot+[only marks,mark=*,mark size=2pt]%
+    \input{\jobname-runlen.pgf}%
+  \else
+    \addplot+[only marks,mark=*,mark size=2pt]
+    coordinates {
+      (0.00, 1.0000)
+      (0.30, 1.4286)
+      (0.60, 2.5000)
+      (0.85, 6.6667)
+      (0.95, 20.0000)
+    };
   \fi
 }
 % ---------------------------------------------------------------------------------------------------------------
@@ -1085,16 +1127,15 @@
   xlabel={Span length \(L\) [km]},
   ylabel={\(P_L\) (BDD)},
   ticklabel style={font=\footnotesize},
-  label style={font=\footnotesize}
+  label style={font=\footnotesize},
+  error bars/y dir=both,
+  error bars/y explicit
 ]
-\addplot+[only marks,mark=*,mark size=2pt]
-  coordinates {
-    \lengthPlotCoords
-  };
+\LengthPlotAdd
 \end{axis}
 \end{tikzpicture}
 \end{adjustbox}
-\caption{Length sweep visualization (points only). CIs for these points are given in Table~\ref{tab:length}. The artifact can emit the exact PGFPlots coordinates via \texttt{--emit-pgf-length}.}
+\caption{Length sweep visualization with optional artifact-generated coordinates. CIs for these points are given in Table~\ref{tab:length}. The artifact can emit the exact PGFPlots coordinates via \texttt{--emit-pgf-length}.}
 \label{fig:length-plot}
 \vspace{0.5em}
 \end{figure}
@@ -1113,16 +1154,15 @@
   xlabel={Classical launch power \(P_{\mathrm{cl}}\) [dBm]},
   ylabel={\(P_L\) (BDD)},
   ticklabel style={font=\footnotesize},
-  label style={font=\footnotesize}
+  label style={font=\footnotesize},
+  error bars/y dir=both,
+  error bars/y explicit
 ]
-\addplot+[only marks,mark=square*,mark size=2pt]
-  coordinates {
-    \powerPlotCoords
-  };
+\PowerPlotAdd
 \end{axis}
 \end{tikzpicture}
 \end{adjustbox}
-\caption{Power sweep visualization (points only). Zero-count estimates are plotted at their one-sided 95\% Clopper--Pearson upper bound \(\num{\simCPUpperZero}\) to be visible on the log scale; Table~\ref{tab:power} reports the exact zero counts and bounds. The artifact can emit the exact PGFPlots coordinates via \texttt{--emit-pgf-power}.}
+\caption{Power sweep visualization with optional artifact-generated coordinates. Zero-count estimates are plotted at their one-sided 95\% Clopper--Pearson upper bound \(\num{\simCPUpperZero}\) to be visible on the log scale; Table~\ref{tab:power} reports the exact zero results. The artifact can emit the exact PGFPlots coordinates via \texttt{--emit-pgf-power}.}
 \label{fig:power-plot}
 \vspace{0.5em}
 \end{figure}
@@ -1141,14 +1181,7 @@
   ticklabel style={font=\footnotesize},
   label style={font=\footnotesize}
 ]
-\addplot+[only marks,mark=*,mark size=2pt]
-coordinates {
-  (0.00, 1.0000)
-  (0.30, 1.4286)
-  (0.60, 2.5000)
-  (0.85, 6.6667)
-  (0.95, 20.0000)
-};
+\RunlenPlotAdd
 \end{axis}
 \end{tikzpicture}
 \end{adjustbox}
@@ -1384,9 +1417,9 @@
 \section{Figure generation provenance (for automated checks)}
 To make the plot pipeline explicit and verifiable:
 - The artifact emits PGFPlots coordinates for each sweep via dedicated flags (\texttt{--emit-pgf-rho}, \texttt{--emit-pgf-runlen}, \texttt{--emit-pgf-length}, \texttt{--emit-pgf-power}, \texttt{--emit-pgf-sep}, \texttt{--emit-pgf-eta}).
-- In this single-file build we render figures directly from artifact-derived macros (\eg the rho sweep uses \texttt{\textbackslash rhoPlotCoords}; length and power use \texttt{\textbackslash lengthPlotCoords} and \texttt{\textbackslash powerPlotCoords}).
+- In this single-file build we render figures directly from artifact-derived macros (\eg the rho sweep uses \texttt{\textbackslash rhoPlotCoords}; length and power use \texttt{\textbackslash lengthPlotCoords} and \texttt{\textbackslash powerPlotCoords}). When shell-escape is enabled, we regenerate the coordinates for rho, length, power, and run length at compile time and input them directly from the generated \texttt{.pgf} files.
 - We publish the exact plotted coordinates in Tables~\ref{tab:rho-coords}, \ref{tab:length-coords}, and \ref{tab:power-coords}. These lines match the artifactâ€™s emitter outputs for the recorded runs.
-- When LaTeX shell-escape is enabled, the rho-sweep plot coordinates are regenerated at compile time from the embedded artifact; otherwise, recorded macros are used. This preserves single-file integrity and provides end-to-end artifact-to-plot traceability.
+- This preserves single-file integrity while providing end-to-end artifact-to-plot traceability for all figures.
 
 \section{Theory and Analytical Bounds}
 - Binomial Chernoff tail (i.i.d.): for \(w\sim\mathrm{Bin}(n,p)\), \( \Pr[w>t] \le \exp\!\big(-n D\big(\tfrac{t+1}{n}\,\|\, p\big)\big)\).
